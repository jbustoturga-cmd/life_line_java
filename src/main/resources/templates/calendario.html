<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mural Digital de Post-its (MySQL Ready)</title>
    <!-- Carga de Tailwind CSS para un diseño moderno y responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"></noscript>
    
    
    
    
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Fondo gris claro */
        }
        /* Estilo para simular el borde rasgado de un post-it */
        .post-it {
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .post-it:hover {
            transform: translateY(-5px) rotate(1deg);
            box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.3);
        }
        :root {
            /* Colores LifeLine */
            --color-primary: #3d5273; /* Azul oscuro */
            --color-secondary: #5b6e94; /* Azul intermedio */
            --color-accent: #8e44ad; /* Púrpura para Organización/Calendario */
            --color-text-dark: #1a1a1a;
            --color-text-light: #555;
            --color-bg-light: #f3f0f7; /* Cambiado a un tono púrpura muy suave */
            --color-bg-white: white;
            --color-menu-bg: #526eaa;
            --color-top-bar-bg: linear-gradient(135deg, #040418, #102468);
            --border-radius-lg: 10px;
            --border-radius-sm: 5px;

            /* Colores para el formulario de citas */
            --form-bg: #e2eaf5; /* Fondo claro para el formulario */
            --input-bg: white;
            --button-bg: #5b6e94;
            --button-hover: #3d5273;
        }
        
        /* Estilos Base */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #cbafdd, #162863);
            color: var(--color-text-dark);
            line-height: 1.6;
        }
        a { text-decoration: none; color: inherit; }

        /* HEADER & NAVBAR (Mantenido) */
        .header-bar {
            background: linear-gradient(135deg, #fefeff, #d2daf5);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header-logo-section { display: flex; align-items: center; }
        .logo-text { font-size: 32px; font-weight: bold; line-height: 28px; color: rgb(13, 26, 68); margin-right: 5px; }
        .header-logo-section img { width: 55px; object-fit: contain; }
        .navbar-right { display: flex; align-items: center; gap: 15px; }
        .navbar-icon a { color: rgb(10, 28, 68); font-size: 24px; transition: color 0.2s; }
        .navbar-icon a:hover { color: var(--color-accent); }
        .user-photo { width: 45px; height: 45px; border-radius: 50%; overflow: hidden; border: 2px solid rgb(3, 3, 3); }
        .user-photo img { width: 100%; height: 100%; object-fit: cover; }
        
        .main-tabs {
            background-color: #2d3e5f;
            display: flex;
            padding: 0 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap; /* Permite que las pestañas se envuelvan en pantallas pequeñas */
        }
        .main-tabs a {
            color: white;
            padding: 10px 20px;
            font-weight: 600;
            transition: background-color 0.2s;
            display: flex; align-items: center; gap: 8px;
        }
        .main-tabs a:hover { background-color: #3b507b; }
        .main-tabs a.active { background-color: var(--color-menu-bg); }

        /* CONTENEDOR PRINCIPAL DEL MÓDULO */
        .calendar-module-container {
            max-width: 1400px;
            margin: 40px auto;
            padding: 20px;
            display: flex;
            gap: 25px;
        }

        /* Columna Izquierda: Calendario y Acciones */
        .calendar-main-area {
            flex: 2;
            background-color: var(--color-bg-white);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .calendar-header h2 {
            font-size: 28px;
            color: var(--color-primary);
        }

        .action-button {
            background-color: var(--color-accent);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
        }
        .action-button:hover { background-color: #7b3ba0; transform: translateY(-1px); }

        /* Lista de Citas (Simulación) - Mantenido */
        .appointment-list {
            list-style: none;
            padding: 0;
            margin-top: 20px;
        }

        .appointment-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: var(--border-radius-sm);
            background-color: var(--color-bg-light);
            border-left: 5px solid var(--color-accent);
            transition: box-shadow 0.2s;
        }
        .appointment-item:hover { box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); }

        /* Columna Derecha: Notificaciones e Historial - Mantenido */
        .sidebar-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .info-box {
            background-color: var(--color-bg-white);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        
        .info-box h3 {
            color: var(--color-accent);
            border-bottom: 2px solid var(--color-bg-light);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        /* --- ESTILOS DEL NUEVO FORMULARIO DE CITA (Basado en la imagen) --- */
        .appointment-form-section {
            padding: 20px;
            background-color: var(--form-bg);
            border-radius: var(--border-radius-lg);
            margin-top: 30px;
        }

        .form-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .form-header h2 {
            font-size: 26px;
            color: var(--color-primary);
        }
        .form-header p {
            color: var(--color-text-light);
        }

        .appointment-type-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .type-button {
            background-color: white;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
            padding: 15px 10px;
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: background-color 0.2s, border-color 0.2s, color 0.2s;
        }

        .type-button:hover, .type-button.selected {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        /* Sección de detalles de la cita */
        .appointment-details-input {
            background-color: #f7f3f9; /* Fondo ligero para la sección de input */
            padding: 20px;
            border-radius: var(--border-radius-lg);
        }

        .appointment-details-input > p {
            text-align: center;
            font-weight: 500;
            color: var(--color-accent);
            margin-bottom: 15px;
        }

        .input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-field {
            display: flex;
            flex-direction: column;
        }

        .form-field label {
            font-weight: 500;
            margin-bottom: 5px;
            color: var(--color-text-dark);
        }

        .form-field input[type="date"],
        .form-field input[type="time"],
        .form-field input[type="text"] {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: var(--border-radius-sm);
            font-size: 16px;
            background-color: var(--input-bg);
        }

        /* Opciones de notificación */
        .notification-options {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px dashed #ccc;
        }

        .notification-options h4 {
            color: var(--color-primary);
            margin-bottom: 10px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            cursor: pointer;
        }

        /* Botón Confirmar */
        .confirm-button-container {
            text-align: center;
            margin-top: 30px;
        }

        .confirm-button {
            background-color: var(--button-bg);
            color: white;
            padding: 12px 40px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .confirm-button:hover {
            background-color: var(--button-hover);
        }

        /* Media Queries */
        @media (max-width: 1100px) {
            .calendar-module-container {
                flex-direction: column;
                margin: 20px;
            }
            .calendar-main-area {
                padding: 20px;
            }
            .input-group, .checkbox-group {
                grid-template-columns: 1fr; /* Una columna en móvil */
            }
            .main-tabs a {
                flex-basis: auto; /* Permite que los links se distribuyan */
            }
        }
         /* Estilo para simular el borde rasgado de un post-it */
        .post-it {
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .post-it:hover {
            transform: translateY(-5px) rotate(1deg);
            box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>

<div class="header-bar">
    <div class="header-logo-section">
        <div class="logo-text">Life<br>Line</div>
        <img src="imagenes/Group 243 (3).png" width="55" alt="logo LifeLine"> 
    </div> 
    <div class="navbar-right">
        <div class="navbar-icon cart-icon"><a th:href="@{/carrito}"><i class="fas fa-shopping-cart" title="Carrito"></i></a></div>
        <div class="user-photo">
            <img src="imagenes/Group 244.png" alt="Foto de usuario" >
        </div>
    </div>
</div>

<nav class="main-tabs">
    <a th:href="@{/home}" ><i class="fas fa-home" title="Inicio"></i>Inicio</a>
    <a th:href="@{/Mural}" ><i class="fas fa-user-friends"></i>Mural</a>
    <a th:href="@{/Perfil}" ><i class="fas fa-user"></i>Perfil</a>
    <a th:href="@{/Tienda}" ><i class="fas fa-store" title="Tienda"></i>Productos</a>
    <a th:href="@{/calendario}" class="active"><i class="fas fa-calendar-alt" title="Calendario"></i>Calendario</a>
    <a th:href="@{/nutricion}" ><i class="fas fa-apple-alt" ></i> Nutrición</a>
    <a th:href="@{/alarma}" ><i class="fas fa-clock"></i> Alarmas</a>
    <a th:href="@{/Contactanos}">Contactanos</a>
</nav>

<div class="calendar-module-container">

    <div class="calendar-main-area">
        <div class="calendar-header">
            <h2><i class="fas fa-calendar-alt"></i> Próximas Citas Médicas</h2>
            <!-- Este botón se puede usar para alternar la visibilidad del formulario de abajo -->
            <button class="action-button" id="toggleFormButton"><i class="fas fa-plus-circle"></i> Nueva Cita</button>
        </div>

        <!-- LISTA DE CITAS EXISTENTES (Mantenido) -->
        <ul class="appointment-list">
            <li class="appointment-item" style="border-left-color: #e74c3c;">
                <div class="appointment-icon" style="color: #e74c3c;"><i class="fas fa-pills"></i></div>
                <div class="appointment-details">
                    <strong>Quimioterapia Sesión #5</strong>
                    <span>15/Diciembre/2025 | 10:00 AM | Hospital Central, Sala B</span>
                </div>
                <div class="appointment-status">Pendiente</div>
            </li>
            <!-- ... Más citas ... -->
            <li class="appointment-item" style="border-left-color: #2ecc71;">
                <div class="appointment-icon" style="color: #2ecc71;"><i class="fas fa-apple-alt"></i></div>
                <div class="appointment-details">
                    <strong>Consulta Nutricional de Seguimiento</strong>
                    <span>10/Diciembre/2025 | 03:00 PM | Consultorio Dra. Díaz</span>
                </div>
                <div class="appointment-status">Pendiente</div>
            </li>
            
            <li class="appointment-item" style="border-left-color: #f39c12;">
                <div class="appointment-icon" style="color: #f39c12;"><i class="fas fa-vial"></i></div>
                <div class="appointment-details">
                    <strong>Examen de Laboratorio (Hemograma)</strong>
                    <span>05/Diciembre/2025 | 07:30 AM | Laboratorio Principal</span>
                </div>
                <div class="appointment-status">Pendiente</div>
            </li>

            <li class="appointment-item" style="border-left-color: #9b59b6;">
                <div class="appointment-icon" style="color: #9b59b6;"><i class="fas fa-brain"></i></div>
                <div class="appointment-details">
                    <strong>Sesión de Psicología</strong>
                    <span>18/Diciembre/2025 | 11:00 AM | Sesión Online (Zoom)</span>
                </div>
                <div class="appointment-status">Pendiente</div>
            </li>
        </ul>

        <!-- NUEVA SECCIÓN: FORMULARIO AGENDAR CITA MÉDICA -->
        <div class="appointment-form-section" id="appointmentForm">
            <div class="form-header">
                <h2>Agendar cita médica</h2>
                <p>Programa tu próxima cita y recibe recordatorios</p>
            </div>

            <!-- Selección de Tipo de Cita -->
            <div class="appointment-type-selection">
                <button class="type-button">Quimioterapia</button>
                <button class="type-button">Radioterapia</button>
                <button class="type-button">Exámenes</button>
                <button class="type-button">Nutrición</button>
            </div>
            
            <!-- Detalles de la Cita (Base de la imagen) -->
            <div class="appointment-details-input">
                <p>programa tu próxima cita y recibe recordatorios</p>
                <div class="input-group">
                    <div class="form-field">
                        <label for="fecha">Fecha</label>
                        <input type="date" id="fecha" name="fecha">
                    </div>
                    <div class="form-field">
                        <label for="hora">Hora</label>
                        <input type="time" id="hora" name="hora">
                    </div>
                </div>

                <div class="input-group">
                    <div class="form-field">
                        <label for="lugar">Lugar</label>
                        <input type="text" id="lugar" name="lugar" placeholder="Hospital Central / Consultorio Dra. X">
                    </div>
                    <div class="form-field">
                        <label for="profesional">Profesional</label>
                        <input type="text" id="profesional" name="profesional" placeholder="Dr. Pérez / Fisioterapeuta María">
                    </div>
                </div>

                <div class="notification-options">
                    <h4>Notificar</h4>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" name="notificar" value="24h"> 24 horas antes
                        </label>
                        <label>
                            <input type="checkbox" name="notificar" value="2h"> 2 horas antes
                        </label>
                        <label>
                            <input type="checkbox" name="recordatorio" value="correo"> recordar por correo
                        </label>
                        <label>
                            <input type="checkbox" name="recordatorio" value="whatsapp"> recordar por whatsapp
                        </label>
                    </div>
                </div>

                <div class="confirm-button-container">
                    <button class="confirm-button">Confirmar cita</button>
                </div>
            </div>
        </div>

    </div>

    <div class="sidebar-area">
        
        <div class="info-box">
            <h3><i class="fas fa-bell"></i> Notificaciones Proactivas</h3>
            
            <div class="notification-item"  style="border: 2px;">
                <i class="fas fa-exclamation-triangle"></i> ¡¡Alerta 24h Quimio!!: Recuerda tomar un desayuno ligero y evitar perfumes fuertes. ¡Revisa tu guía de pre-cita!
            </div>
            
            <div class="notification-item motivational">
                <i class="fas fa-heart" ></i> ¡¡Motivación LifeLine!!: Hoy es un buen día para avanzar. Recuerda hidratarte y que eres más fuerte de lo que crees.
            </div>

            <div class="notification-item" style="border-left-color: #3498db; background-color: #e8f5ff;">
                <i class="fas fa-tint"></i> ¡¡Tip de Hidratación!!: ¡Bebe 2 vasos de agua antes del mediodía! La hidratación constante es clave para la Nutrición.
            </div>
        </div>

        <div class="info-box">
            <h3><i class="fas fa-history"></i> Historial de Asistencias</h3>
            
            <div class="history-item">
                <span>Quimioterapia Sesión #4</span>
                <span class="status-check">Asistida <i class="fas fa-check"></i></span>
            </div>
            
            <div class="history-item">
                <span>Examen T4 (02/Nov)</span>
                <span class="status-check">Asistida <i class="fas fa-check"></i></span>
            </div>

            <div class="history-item" style="border-bottom: none;">
                <span>Consulta Psicología (Oct)</span>
                <span style="color: #c0392b; font-weight: bold;">Cancelada <i class="fas fa-times"></i></span>
            </div>
        </div>

    </div>
</div>

<div id="app-container" class="max-w-6xl mx-auto bg-white shadow-2xl rounded-xl p-6 md:p-10">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-2 border-b-4 border-blue-500 pb-2">
            Mural Digital de Post-its
        </h1>
        <p class="text-sm text-gray-500 mb-6">
            Agrega ideas, tareas o pendientes.
        </p>

        <!-- Formulario para agregar/editar notas -->
        <div class="mb-8 p-4 bg-blue-50 rounded-lg shadow-inner border border-blue-200">
            <form id="note-form">
                <input type="hidden" id="note-id" value="">
                <div class="flex flex-col gap-4">
                    <!-- Campo de texto de la nota -->
                    <textarea id="note-text" placeholder="Escribe tu idea o nota aquí (máx. 150 caracteres)"
                        maxlength="150" rows="3"
                        class="p-3 border border-blue-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-yellow-500 transition duration-150"
                        required></textarea>
                    
                    <div class="flex flex-col sm:flex-row gap-4 sm:items-center">
                        <!-- Selector de Categoría/Color -->
                        <select id="note-category" 
                            class="p-3 border border-yellow-300 rounded-lg bg-white focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 transition duration-150 sm:w-1/3">
                            <option value="Idea">Idea (Amarillo)</option>
                            <option value="Tarea">Tarea (Azul)</option>
                            <option value="Importante">Importante (Rojo)</option>
                            <option value="Hecho">Hecho (Verde)</option>
                        </select>
                        
                        <!-- Botón de Enviar -->
                        <button type="submit" id="submit-button"
                            class="w-full sm:flex-grow px-6 py-3 bg-yellow-600 text-white font-semibold rounded-lg shadow-md hover:bg-yellow-700 transition duration-150 transform hover:scale-[1.02]">
                            Agregar Post-it
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <!-- Contenedor del Mural (Grid de Post-its) -->
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Mural de Ideas</h2>
        <div id="note-mural" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 p-2">
            <!-- Los post-its se inyectarán aquí -->
        </div>

        <!-- Mensaje de estado/error -->
        <div id="status-message" class="mt-6 p-3 text-center rounded-lg hidden"></div>
    </div>



        <!-- Mensaje de estado/error -->
        <div id="status-message" class="mt-6 p-3 text-center rounded-lg hidden"></div>
    </div>



<script>
    // Script para simular el toggle del formulario al hacer clic en "Nueva Cita"
    document.addEventListener('DOMContentLoaded', function() {
        const formSection = document.getElementById('appointmentForm');
        const toggleButton = document.getElementById('toggleFormButton');

        // Inicialmente ocultamos el formulario, ya que la lista de citas es lo principal.
        formSection.style.display = 'none'; 

        toggleButton.addEventListener('click', function() {
            if (formSection.style.display === 'none' || formSection.style.display === '') {
                formSection.style.display = 'block';
                toggleButton.innerHTML = '<i class="fas fa-times-circle"></i> Cerrar Formulario';
            } else {
                formSection.style.display = 'none';
                toggleButton.innerHTML = '<i class="fas fa-plus-circle"></i> Nueva Cita';
            }
        });
        
        // Simular la selección de botones de tipo de cita
        const typeButtons = document.querySelectorAll('.type-button');
        typeButtons.forEach(button => {
            button.addEventListener('click', function() {
                typeButtons.forEach(btn => btn.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

    });
 let notes = [];
        let nextId = 1; // Para simular auto-incremento de ID

        const noteMural = document.getElementById('note-mural');
        const noteForm = document.getElementById('note-form');
        const noteTextInput = document.getElementById('note-text');
        const noteCategoryInput = document.getElementById('note-category');
        const noteIdInput = document.getElementById('note-id');
        const submitButton = document.getElementById('submit-button');
        const statusMessage = document.getElementById('status-message');

        // Mapa de colores para las categorías
        const colorMap = {
            'Idea': 'bg-yellow-200 border-yellow-600 text-yellow-900',
            'Tarea': 'bg-blue-200 border-blue-600 text-blue-900',
            'Importante': 'bg-red-200 border-red-600 text-red-900',
            'Hecho': 'bg-green-200 border-green-600 text-green-900'
        };
        const buttonColorMap = {
            'Idea': 'bg-yellow-500 hover:bg-yellow-600',
            'Tarea': 'bg-blue-500 hover:bg-blue-600',
            'Importante': 'bg-red-500 hover:bg-red-600',
            'Hecho': 'bg-green-500 hover:bg-green-600'
        };

        // Función de utilidad para mostrar mensajes
        function showMessage(message, type = 'info') {
            statusMessage.textContent = message;
            statusMessage.className = `mt-6 p-3 text-center rounded-lg block`;
            
            // Estilos Tailwind basados en el tipo de mensaje
            if (type === 'success') {
                statusMessage.classList.add('bg-green-100', 'text-green-800');
            } else if (type === 'error') {
                statusMessage.classList.add('bg-red-100', 'text-red-800');
            } else { // info (o cualquier otro)
                statusMessage.classList.add('bg-blue-100', 'text-blue-800');
            }
            // Ocultar mensaje después de 4 segundos
            setTimeout(() => {
                statusMessage.classList.add('hidden');
            }, 4000);
        }

        // --- FUNCIONES QUE DEBES ADAPTAR PARA TU API REST DE MYSQL ---

        /**
         * @async
         * Carga todas las notas del Mural de la base de datos MySQL.
         * REEMPLAZA este cuerpo por una llamada 'fetch' a tu endpoint GET /api/notes
         */
        async function loadNotes() {
            console.log('--- Simulando carga de datos desde MySQL ---');
            try {
                // *** INICIO: CÓDIGO DE SIMULACIÓN (Reemplazar con fetch) ***
                
                // Simulación de datos iniciales
                if (notes.length === 0) {
                     notes = [
                        { id: 1, text: 'ejemplo texto 1 (id, content, category)', category: 'Tarea' },
                        { id: 2, text: 'ejemplo texto 2', category: 'Idea' },
                        { id: 3, text: 'ejemplo texto 3', category: 'Importante' }
                    ];
                    nextId = 4;
                }
                
                // Simulación de tiempo de carga (ej. 500ms de latencia de red)
                await new Promise(resolve => setTimeout(resolve, 500)); 
                
                // *** FIN: CÓDIGO DE SIMULACIÓN ***

                renderNotes();
                showMessage('Notas cargadas correctamente (simulación).', 'success');
            } catch (error) {
                console.error('Error al cargar las notas:', error);
                showMessage('Error al conectar con la base de datos (simulación).', 'error');
            }
        }

        /**
         * @async
         * Guarda una nota nueva o actualiza una existente en MySQL.
         * REEMPLAZA este cuerpo por una llamada 'fetch' (POST para nuevo, PUT/PATCH para actualizar).
         */
        async function saveNote(noteData) {
            console.log('--- Simulando guardar/actualizar nota en MySQL ---', noteData);
            try {
                // Simulación de tiempo de guardado
                await new Promise(resolve => setTimeout(resolve, 500));
                
                if (noteData.id) {
                    // *** ACTUALIZAR (Llamada PUT/PATCH a /api/notes/{id}) ***
                    const index = notes.findIndex(n => n.id === noteData.id);
                    if (index !== -1) {
                        notes[index].text = noteData.text;
                        notes[index].category = noteData.category;
                        showMessage('Nota actualizada exitosamente (simulación).', 'success');
                    }
                } else {
                    // *** CREAR NUEVO (Llamada POST a /api/notes) ***
                    const newNote = { 
                        id: nextId++, 
                        text: noteData.text, 
                        category: noteData.category 
                    };
                    notes.push(newNote);
                    showMessage('Nota agregada exitosamente (simulación).', 'success');
                }
                
                renderNotes(); // Volver a renderizar para reflejar el cambio
            } catch (error) {
                console.error('Error al guardar la nota:', error);
                showMessage('Error de servidor al guardar la nota (simulación).', 'error');
            }
        }

        /**
         * @async
         * Elimina una nota de MySQL.
         * REEMPLAZA este cuerpo por una llamada 'fetch' a tu endpoint DELETE /api/notes/{id}
         */
        async function deleteNote(id) {
            console.log('ejemplo', id);
            try {
                // Simulación de tiempo de eliminación
                await new Promise(resolve => setTimeout(resolve, 500));

                // Filtrar el array para remover la nota
                notes = notes.filter(n => n.id !== id);
                
                renderNotes();
                showMessage('Nota eliminada exitosamente (simulación).', 'success');
            } catch (error) {
                console.error('Error al eliminar la nota:', error);
                showMessage('Error de servidor al eliminar la nota (simulación).', 'error');
            }
        }
        
        // --- LÓGICA DEL FRONT-END ---

        // Maneja el envío del formulario (agregar o editar)
        noteForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const text = noteTextInput.value.trim();
            const category = noteCategoryInput.value;
            const id = noteIdInput.value ? parseInt(noteIdInput.value) : null;

            if (text === '') return;

            await saveNote({ id, text, category });

            // Limpiar el formulario y resetear el botón
            noteTextInput.value = '';
            noteCategoryInput.value = 'Idea'; // Resetear a default
            noteIdInput.value = '';
            submitButton.textContent = 'Agregar Post-it';
        });

        // Maneja clicks en los botones de la lista (editar, eliminar)
        noteMural.addEventListener('click', async (e) => {
            const button = e.target.closest('button');
            if (!button) return;
            
            const id = parseInt(button.dataset.id);
            if (isNaN(id)) return;

            if (button.classList.contains('delete-btn')) {
                // Eliminar Nota
                if (confirm('¿Estás seguro de que quieres eliminar este Post-it?')) {
                    await deleteNote(id);
                }
            } else if (button.classList.contains('edit-btn')) {
                // Editar Nota: Carga los datos al formulario
                const note = notes.find(n => n.id === id);
                if (note) {
                    noteTextInput.value = note.text;
                    noteCategoryInput.value = note.category;
                    noteIdInput.value = id;
                    submitButton.textContent = 'Guardar Edición';
                    noteTextInput.focus();
                    showMessage(`Editando Post-it con ID ${id}.`, 'info');
                }
            }
        });

        // Renderiza el Mural en el DOM
        function renderNotes() {
            noteMural.innerHTML = ''; // Limpiar mural
            
            if (notes.length === 0) {
                noteMural.innerHTML = '<p class="text-gray-500 text-center py-4 col-span-full">Tu mural está vacío. ¡Agrega tu primera idea!</p>';
                return;
            }

            // Ordenar por ID para una vista consistente
            const sortedNotes = [...notes].sort((a, b) => a.id - b.id);

            sortedNotes.forEach(note => {
                const colors = colorMap[note.category] || colorMap['Idea'];
                const buttonColors = buttonColorMap[note.category] || buttonColorMap['Idea'];

                const noteItem = document.createElement('div');
                noteItem.className = `post-it p-5 rounded-lg border-b-8 shadow-lg break-inside-avoid ${colors}`;
                
                // Contenido del post-it
                noteItem.innerHTML = `
                    <p class="font-bold text-sm mb-2">${note.category}</p>
                    <p class="whitespace-pre-wrap mb-4 text-lg">${note.text}</p>
                    
                    <div class="flex justify-end space-x-2 border-t pt-2 border-current">
                        <!-- Botón de Editar -->
                        <button data-id="${note.id}" class="edit-btn p-2 rounded-full text-white ${buttonColors} transition duration-150 transform hover:scale-110"
                            title="Editar Post-it">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zm-1.414 7.072L6 14.172V12H3v-2.172L12.586 3.586 16.414 7.414z" />
                            </svg>
                        </button>
                        
                        <!-- Botón de Eliminar -->
                        <button data-id="${note.id}" class="delete-btn p-2 bg-gray-500 hover:bg-gray-600 rounded-full text-white transition duration-150 transform hover:scale-110"
                            title="Eliminar Post-it">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                        </button>
                    </div>
                `;
                noteMural.appendChild(noteItem);
            });
        }

        // Iniciar la aplicación cargando las notas
        window.onload = loadNotes;

    </script>
</body>
</html>


   
       